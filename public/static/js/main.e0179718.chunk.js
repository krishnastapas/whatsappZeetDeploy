(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{105:function(e,t,a){},109:function(e,t,a){},111:function(e,t,a){},113:function(e,t,a){},115:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),r=a(54),s=a.n(r),l=(a(73),a(75),a(10)),u=(a(77),a(0)),o=a.n(u),i=a(2),m=a(140),d=a(130),p=a(132),h=a(133),f=a(131),E=a(134),v=(a(81),a(55)),b=a.n(v).a.create({baseURL:"http://localhost:9000"}),g=function(){var e=Object(i.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return b.defaults.withCredentials=!0,e.next=3,b.get("/api/v1/users/sync",{headers:{withCredentials:!0}});case 3:(a=e.sent).data&&(t.user_update(a.data),t.logedin_update(!0));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),w=Object(n.createContext)();a(105);var C=function(e){var t=e.addNewChat,a=e.chat,r=Object(n.useContext)(w),s=c.a.useState(!1),u=Object(l.a)(s,2),p=u[0],h=u[1],E=c.a.useState(!1),v=Object(l.a)(E,2),C=v[0],j=v[1],O=Object(n.useState)(""),x=Object(l.a)(O,2),N=x[0],k=x[1],y=Object(n.useState)(""),_=Object(l.a)(y,2),S=_[0],I=_[1],F=function(){var e=Object(i.a)(o.a.mark(function e(){var t,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h(!p),b.defaults.withCredentials=!0,e.next=4,b.post("/api/v1/users/chats/new",{name:S,email:N,headers:{withCredentials:!0}});case 4:if(201!==(t=e.sent).status&&200!==t.status){e.next=10;break}return e.next=8,g(r);case 8:a=e.sent,console.log(a);case 10:200===t.status?alert('Chat already exit with name:" '+t.data.name+' ". Please check your chat......'):400===t.status&&alert("user with given email is not exit or session expired."),k(""),I("");case 13:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return j(!C),b.defaults.withCredentials=!0,e.next=4,b.post("/api/v1/users/chats/remove",{email:a.email,headers:{withCredentials:!0}});case 4:e.sent&&r.updateChat(null);case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(i.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return j(!C),b.defaults.withCredentials=!0,e.next=4,b.post("/api/v1/users/chats/delete",{email:a.email,chatId:a.chatId,headers:{withCredentials:!0}});case 4:t=e.sent,console.log(t),r.updateChat(null);case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return t?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{onClick:function(){return h(!p)},className:"sidebarChat"},c.a.createElement("h2",null,"Add new Chat")),p&&c.a.createElement("div",{className:"popUpForm"},c.a.createElement("form",{className:"popUpForm_info",onSubmit:F},c.a.createElement("input",{type:"text",value:S,placeholder:"Name",onChange:function(e){I(e.target.value)}}),c.a.createElement("input",{type:"text",value:N,placeholder:"Email ",onChange:function(e){k(e.target.value)}}),c.a.createElement("input",{type:"submit",value:"Submit"})))):c.a.createElement("div",{onClick:function(){r.updateChat(a)},className:"sidebarChat"},c.a.createElement(m.a,{src:a.chatPhoto}),c.a.createElement("div",{className:"sidebarchat_info"},c.a.createElement("h2",null,a.name),c.a.createElement("p",null,"last message.....")),c.a.createElement("div",{className:"moreVert",onClick:function(){return j(!C)}},c.a.createElement(d.a,null,c.a.createElement(f.a,null))),C&&c.a.createElement("ul",{className:"drop-down"},c.a.createElement("li",null,c.a.createElement("button",{onClick:L},"Remove")),c.a.createElement("li",null,c.a.createElement("button",{onClick:R},"Delete"))))};var j=function(){var e=Object(n.useState)([]),t=Object(l.a)(e,2),a=t[0],r=t[1],s=c.a.useState(!1),u=Object(l.a)(s,2),v=u[0],g=u[1],j=Object(n.useContext)(w);Object(n.useEffect)(function(){j.state&&r(j.state.chats)},[j.state]);var O=function(){var e=Object(i.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.post("/api/v1/users/logout",{headers:{withCredentials:!0}});case 2:"user got sign out"===e.sent.data&&(j.user_update(null),j.updateChat(null),j.logedin_update(!1));case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return c.a.createElement("div",{className:"sidebar"},c.a.createElement("div",{className:"sidebar_header"},c.a.createElement(m.a,{src:j.state?j.state.photoURL:""}),c.a.createElement("div",{className:"sidebar_headerRight"},c.a.createElement(d.a,null,c.a.createElement(p.a,null)),c.a.createElement(d.a,null,c.a.createElement(h.a,null)),c.a.createElement("div",{onClick:function(){return g(!v)}},c.a.createElement(d.a,null,c.a.createElement(f.a,null)))),v&&c.a.createElement("ul",{className:"drop-down"},c.a.createElement("li",null,c.a.createElement("button",{onClick:O},"Logout")))),c.a.createElement("div",{className:"sidebar_search"},c.a.createElement("div",{className:"sidebar_searchContainer"},c.a.createElement(E.a,null),c.a.createElement("input",{placeholder:"Search or Satart a new chat",type:"text"}))),c.a.createElement("div",{className:"sidebar_chats"},c.a.createElement(C,{addNewChat:!0}),a?a.map(function(e){return e.show?c.a.createElement(C,{chat:e}):""}):""))},O=a(135),x=a(136),N=a(137);a(109),a(111);var k=function(e){var t=e.message,a=Object(n.useContext)(w);return console.log("Message........."),console.log(t),c.a.createElement(c.a.Fragment,null,t?c.a.createElement("div",{className:"chat_message ".concat(t.email===a.state.email&&"chat_receiver")},c.a.createElement("p",null,c.a.createElement("span",{className:"chat_name"},t.name),t.message,c.a.createElement("span",{className:"chat_timestamp"},t.time))):"")};var y=function(e){var t=e.messages,a=Object(n.useState)(""),r=Object(l.a)(a,2),s=r[0],u=r[1],p=Object(n.useContext)(w);console.log("messages...\n "),console.log(t);var h=function(){var e=Object(i.a)(o.a.mark(function e(t){var a,n,c,r,l;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=new Date,n=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate(),c=a.getHours()+":"+a.getMinutes()+":"+a.getSeconds(),r=n+" "+c,console.log("You typed: ",s),b.defaults.withCredentials=!0,e.next=9,b.post("/api/v1/chat/messages/new",{chatId:p.chat.chatId,message:s,time:r,headers:{withCredentials:!0}});case 9:l=e.sent,console.log(l),u("");case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return c.a.createElement("div",{className:"chat"},c.a.createElement("div",{className:"chat_header"},c.a.createElement(m.a,{src:p.chat.chatPhoto}),c.a.createElement("div",{className:"chat_headerInfo"},c.a.createElement("h3",null,p.chat.name),c.a.createElement("p",null,p.chat.email)),c.a.createElement("div",{className:"chat_headerRight"},c.a.createElement(d.a,null),c.a.createElement(E.a,null),c.a.createElement(d.a,null),c.a.createElement(d.a,null),c.a.createElement(O.a,null),c.a.createElement(d.a,null),c.a.createElement(d.a,null),c.a.createElement(f.a,null),c.a.createElement(d.a,null))),c.a.createElement("div",{className:"chat_body"},t?t.map(function(e){return c.a.createElement(k,{message:e})}):"",c.a.createElement(k,null)),c.a.createElement("div",{className:"chat_footer"},c.a.createElement(x.a,null),c.a.createElement("form",null,c.a.createElement("input",{value:s,onChange:function(e){return u(e.target.value)},type:"text",placeholder:"Type a message"}),c.a.createElement("button",{onClick:h,type:"submit"},"send a message")),c.a.createElement(N.a,null)))},_=a(42),S=a.n(_),I=a(138),F=(a(113),a(36)),L=a(61);var R=function(){var e=Object(n.useContext)(w),t=Object(L.a)({apiKey:"AIzaSyBXq0konJnsdLJgdjMaIWo6EIf8JXqpNoQ",authDomain:"whats-app-clone-65f0d.firebaseapp.com",projectId:"whats-app-clone-65f0d",storageBucket:"whats-app-clone-65f0d.appspot.com",messagingSenderId:"604182016124",appId:"1:604182016124:web:cabddf1a3aacd3828c99f9",measurementId:"G-P6703LXHNH"}),a=Object(F.b)(t),r=new F.a,s=function(){var t=Object(i.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:Object(F.c)(a,r).then(function(){var t=Object(i.a)(o.a.mark(function t(a){var n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.post("api/v1/users/login",{idToken:a.user.accessToken,name:a.user.displayName,email:a.user.email,photoURL:a.user.photoURL},{withCredentials:!0});case 2:n=t.sent,console.log(n.data),"user not valid"!==n.data&&e.user_update(n.data);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()).catch(function(e){var t=e.code;console.log(t);var a=e.message;console.log(a);var n=e.customData.email;console.log(n);var c=F.a.credentialFromError(e);console.log(c)});case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}();return c.a.createElement("div",{className:"login"},c.a.createElement("div",{className:"login_container"},c.a.createElement("div",{className:"login_text"},c.a.createElement("h1",null,"Sign in to WhatsApp")),c.a.createElement(I.a,{onClick:s},"Sign in with Google")))},D=function(){var e=Object(i.a)(o.a.mark(function e(t,a){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("user.chat:"+t.chat),!t.chat){e.next=8;break}return console.log("chat id :"+t.chat.chatId),b.defaults.withCredentials=!0,e.next=6,b.post("/api/v1/chat/messages/sync",{chatId:t.chat.chatId,headers:{withCredentials:!0}});case 6:(n=e.sent)&&(console.log(n.data),console.log(n.data.messages),a(n.data.messages));case 8:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}();var P=function(){var e=Object(n.useContext)(w),t=Object(n.useState)(),a=Object(l.a)(t,2),r=a[0],s=a[1];return Object(n.useEffect)(function(){g(e)},[]),Object(n.useEffect)(function(){D(e,s)},[e.chat]),Object(n.useEffect)(function(){var t=new S.a("0403674da6773397d012",{cluster:"ap2"}).subscribe("users");return t.bind("updated",function(t){t.updated&&g(e)}),function(){t.unbind_all(),t.unsubscribe()}},[]),Object(n.useEffect)(function(){var t=new S.a("0403674da6773397d012",{cluster:"ap2"}).subscribe("chats");return t.bind("updated",function(t){t.updated&&D(e,s)}),function(){t.unbind_all(),t.unsubscribe()}},[r]),console.log("displaying message"),console.log(r),c.a.createElement("div",{className:"app"},e.state?c.a.createElement("div",{className:"app_body"},c.a.createElement(j,null),e.chat?c.a.createElement(y,{messages:r}):" "):c.a.createElement(R,null))};var U=function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement(P,null))},J=function(e){e&&e instanceof Function&&a.e(1).then(a.bind(null,139)).then(function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;a(e),n(e),c(e),r(e),s(e)})},M=function(e){var t=Object(n.useState)(),a=Object(l.a)(t,2),r=a[0],s=a[1],u=Object(n.useState)(!1),o=Object(l.a)(u,2),i=o[0],m=o[1],d=Object(n.useState)(),p=Object(l.a)(d,2),h=p[0],f=p[1],E=Object(n.useCallback)(function(e){s(e)},[r]);return c.a.createElement(w.Provider,{value:{state:r,user_update:E,islogedin:i,logedin_update:function(e){m(e)},chat:h,updateChat:function(e){f(e)}}},e.children)};s.a.createRoot(document.getElementById("root")).render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(M,null,c.a.createElement(U,null)))),J()},66:function(e,t,a){e.exports=a(115)},73:function(e,t,a){},75:function(e,t,a){},77:function(e,t,a){},81:function(e,t,a){}},[[66,3,2]]]);
//# sourceMappingURL=main.e0179718.chunk.js.map